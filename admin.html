<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Santic Barber</title>
    <link rel="stylesheet" href="admin.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">

        <section id="login-section" class="admin-section active">
            <h1>Acceso Administrador</h1>
            <form id="login-form">
                <div class="form-group">
                    <label for="email">Correo Electrónico:</label> <input type="email" id="email" required placeholder="Correo electrónico"> </div>
                <div class="form-group">
                    <label for="password">Contraseña:</label>
                    <input type="password" id="password" required placeholder="Contraseña"> </div>
                <button type="submit" class="admin-button primary">Ingresar</button>
                <p id="login-error" class="error-message" style="display: none;">Correo electrónico o contraseña incorrectos.</p>
            </form>
        </section>

        <section id="admin-panel" class="admin-section">
            <header class="admin-header">
                <h1>Panel de Administración - Santic Barber</h1>
                <button id="logout-button" class="admin-button danger">Cerrar Sesión</button>
            </header>

            <div class="admin-tabs">
                <button class="tab-button active" data-tab="appointments" aria-controls="appointments-tab">Citas</button>
                <button class="tab-button" data-tab="standard-schedule" aria-controls="standard-schedule-tab">Horario Estándar</button>
                <button class="tab-button" data-tab="availability" aria-controls="availability-tab">Excepciones/Bloqueos</button>
                <button class="tab-button" data-tab="services" aria-controls="services-tab">Gestionar Servicios</button>
            </div>

            <div class="admin-content">
                <div id="appointments-tab" class="tab-content active" role="tabpanel">
                    <h2>Citas Registradas</h2>
                     <p id="appointments-feedback" class="feedback-message" aria-live="polite"></p>
                    <div id="appointments-list">
                        <p class="placeholder">Cargando citas...</p>
                        </div>
                </div>

                <div id="standard-schedule-tab" class="tab-content" role="tabpanel">
                    <h2>Horario Estándar Semanal</h2>
                    <p>Define los horarios habituales de apertura para cada día de la semana. Puedes activar/desactivar días completos o solo los periodos de mañana/tarde. Estos se aplicarán a todas las semanas a menos que definas una excepción específica para un día concreto en la pestaña 'Excepciones/Bloqueos'.</p>
                    <form id="standard-schedule-form">
                        <div id="weekly-schedule-inputs">
                             <p class="placeholder">Cargando configuración del horario...</p>
                        </div>
                        <button type="submit" class="admin-button success">Guardar Horario Estándar</button>
                        <p id="schedule-save-feedback" class="feedback-message" aria-live="polite"></p>
                    </form>
                </div>

                <div id="availability-tab" class="tab-content" role="tabpanel">
                    <h2>Excepciones y Bloqueos Específicos</h2>
                    <p>Selecciona una fecha para ver la disponibilidad calculada (considerando horario estándar, citas y bloqueos). Puedes añadir o quitar <strong>bloqueos específicos</strong> (excepciones) para anular la disponibilidad de un horario en esa fecha concreta.</p>
                    <div class="form-group availability-date-selector">
                        <label for="availability-date">Seleccionar Fecha:</label>
                        <input type="date" id="availability-date">
                    </div>
                    <div id="availability-time-slots">
                        <p class="placeholder">Selecciona una fecha para ver y modificar los horarios.</p>
                        </div>
                </div>

                <div id="services-tab" class="tab-content" role="tabpanel">
                    <h2>Gestionar Servicios</h2>
                    <p>Añade, edita, activa/desactiva o elimina los servicios ofrecidos. Los servicios activos se mostrarán en la página de reservas.</p>

                    <div class="admin-actions-bar">
                        <button id="add-new-service-btn" type="button" class="admin-button success">Añadir Nuevo Servicio</button>
                    </div>

                    <div id="services-list-admin">
                       <p class="placeholder">Cargando servicios...</p>
                    </div>

                    <p id="services-admin-feedback" class="feedback-message" aria-live="polite"></p>
                </div>

            </div>

        </section>

    </div>

    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"; // Updated to a more recent, stable version
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
      import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
      import { getDatabase, ref, set, get, child, remove, update } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyBHaT9gQRq1e58VjX798LnkxqLtjF9W9DA", // KEEP YOUR KEY SECRET
        authDomain: "santicbarber.firebaseapp.com",
        databaseURL: "https://santicbarber-default-rtdb.firebaseio.com", // Added Database URL
        projectId: "santicbarber",
        storageBucket: "santicbarber.firebasestorage.app",
        messagingSenderId: "52314683922",
        appId: "1:52314683922:web:b61e2332935a731ed6b6cb",
        measurementId: "G-W9ZEM88PZ7"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
      const auth = getAuth(app);
      const database = getDatabase(app);

      // Make Firebase services available globally for admin.js
      window.firebaseServices = {
          auth,
          database,
          signInWithEmailAndPassword,
          signOut,
          onAuthStateChanged,
          ref,
          set,
          get,
          child,
          remove,
          update
      };
    </script>

    <script src="admin.js"></script>
</body>
</html>
